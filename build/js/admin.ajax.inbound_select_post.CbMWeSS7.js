var w=(e,r,i)=>new Promise((l,s)=>{var n=o=>{try{t(i.next(o))}catch(c){s(c)}},a=o=>{try{t(i.throw(o))}catch(c){s(c)}},t=o=>o.done?l(o.value):Promise.resolve(o.value).then(n,a);t((i=i.apply(e,r)).next())});import{S as g}from"./admin.cache.4-osdmxG.js";import{c as x}from"./admin.check_lrseo_page.Ci4yMWoH.js";jQuery(document).ready(function(e){if(!x())return;const r=e("#inbound_select_post");r.on("click",function(l){l.preventDefault();const s=e('select[name="post_id"]').val(),n=e("#inbound_kw_post").val(),a=e('select[name="post_id"] option:selected').data("title"),t=[];if(!n){alert("Veuillez renseigner un mot-cl√©");return}r.attr("disabled",!0),r.text("Analyse des articles en cours...");const o=g.get(`lrseo_inbound_select_post_${s}_${n}`);if(o){t.push(...o),i(t,s);return}const c=new URL(window.location.href);c.searchParams.set("lrseo_inbound_post_select",s),window.history.replaceState({},"",c);const p=e("#inbound_progress_bar"),m=e("#inbound_progress_bar_text"),h=p.find(".bar");p.removeClass("lr-hidden"),h.attr("style","width: 0%;");const d=e('select[name="post_id"] option').length-1,b=50,f=[];m.text(`0/${d}`);for(let u=0;u<d;u+=b){const y={action:"lrseo_inbound_select_post",kw:n,title:a,post_id:s,current:u,step:b,security:lrseo_inbound_select_post.nonce};f.push(new Promise(v=>w(this,null,function*(){yield new Promise(_=>setTimeout(_,u*50)),e.post(lrseo_inbound_select_post.url,y,_=>{_.success&&(t.push(..._.data),m.text(`${t.length}/${d}`),h.attr("style",`width: ${Math.round(t.length/d*100)}%;`)),v()})})))}Promise.all(f).then(()=>{p.addClass("lr-hidden"),g.store(t,`lrseo_inbound_select_post_${s}_${n}`,60),i(t,s)})});function i(l,s){l.sort((a,t)=>t.score-a.score),e("#inbound_table_results").removeClass("lr-hidden"),e("#inbound_results").removeClass("lr-hidden"),e("#inbound_src_post").val(s),r.attr("disabled",!1),r.text("Voir les articles sources potentiels");const n=e("#inbound_tbody_results");if(n.html(""),l){const a=l.map(t=>`<tr>
                    <th scope="row" class="check-column"><input type="checkbox" name="post[]" ${t.score>=85&&"checked"} data-id="${t.id}" data-title="${t.title}"/></th>
                    <td class="title has-row-actions column-title column-primary lr-max-w-[800px] lr-overflow-y-scroll">
                        <strong>${t.titre||t.title||""}</strong>
                        <div class="row-actions">
                            <span class="edit"><a href="/wp-admin/post.php?post=${t.id}&action=edit">Modifier</a> | </span>
                            <span class="view"><a href="/?p=${t.id}" target="_blank">Voir</a></span>
                        </div>
                    </td>
                    <td>${t.score}</td>
                    <td>${Intl.NumberFormat("fr-FR",{maximumFractionDigits:2}).format(t.pct_links/100)}</td>
                </tr>`).join("");n.html(a)}}});
