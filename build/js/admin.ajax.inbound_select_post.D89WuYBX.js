var f=(e,r,i)=>new Promise((a,o)=>{var l=n=>{try{t(i.next(n))}catch(c){o(c)}},s=n=>{try{t(i.throw(n))}catch(c){o(c)}},t=n=>n.done?a(n.value):Promise.resolve(n.value).then(l,s);t((i=i.apply(e,r)).next())});import{S as w}from"./admin.cache.4-osdmxG.js";import{c as v}from"./admin.check_lrseo_page.Ci4yMWoH.js";jQuery(document).ready(function(e){if(!v())return;const r=e("#inbound_select_post");r.on("click",function(a){a.preventDefault();const o=e('select[name="post_id"]').val(),l=e("#inbound_kw_post").val(),s=[];if(!l){alert("Veuillez renseigner un mot-cl√©");return}r.attr("disabled",!0),r.text("Analyse des articles en cours...");const t=w.get(`lrseo_inbound_select_post_${o}`);if(t){s.push(...t),i(s,o);return}const n=new URL(window.location.href);n.searchParams.set("lrseo_inbound_post_select",o),window.history.replaceState({},"",n);const c=e("#inbound_progress_bar"),p=e("#inbound_progress_bar_text"),h=c.find(".bar");c.removeClass("lr-hidden"),h.attr("style","width: 0%;");const d=e('select[name="post_id"] option').length-1,m=10,b=[];p.text(`0/${d}`);for(let u=0;u<d;u+=m){const g={action:"lrseo_inbound_select_post",kw:l,post_id:o,current:u,step:m,security:lrseo_inbound_select_post.nonce};b.push(new Promise(y=>f(this,null,function*(){yield new Promise(_=>setTimeout(_,u*50)),e.post(lrseo_inbound_select_post.url,g,_=>{_.success&&(s.push(..._.data),p.text(`${s.length}/${d}`),h.attr("style",`width: ${Math.round(s.length/d*100)}%;`)),y()})})))}Promise.all(b).then(()=>{c.addClass("lr-hidden"),w.store(s,`lrseo_inbound_select_post_${o}`,60),i(s,o)})});function i(a,o){a.sort((s,t)=>t.score-s.score),e("#inbound_table_results").removeClass("lr-hidden"),e("#inbound_results").removeClass("lr-hidden"),e("#inbound_src_post").val(o),r.attr("disabled",!1),r.text("Voir les articles de destination");const l=e("#inbound_tbody_results");if(l.html(""),a){const s=a.map(t=>`<tr>
                    <th scope="row" class="check-column"><input type="checkbox" name="post[]" ${t.score>=85&&"checked"} data-id="${t.id}" data-title="${t.title}"/></th>
                    <td class="title has-row-actions column-title column-primary">
                        <strong>${t.titre||t.title||""}</strong>
                        <div class="row-actions">
                            <span class="edit"><a href="/wp-admin/post.php?post=${t.id}&action=edit">Modifier</a> | </span>
                            <span class="view"><a href="/?p=${t.id}" target="_blank">Voir</a></span>
                        </div>
                    </td>
                    <td>${t.score}</td>
                </tr>`).join("");l.html(s)}}});
